{
    "sourceFile": "src/components/ModifierGestionnaire.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 9,
            "patches": [
                {
                    "date": 1749324942992,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1749325072869,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,10 +6,9 @@\n     DialogBody,\r\n     DialogFooter,\r\n     Input,\r\n     Button,\r\n-    Select,\r\n-    Option,\r\n+  \r\n } from \"@material-tailwind/react\";\r\n import { useState } from \"react\";\r\n \r\n import { ToastContainer, toast } from 'react-toastify';\r\n@@ -20,10 +19,9 @@\n         id: gestionnaire?._id || \"\",\r\n         name: gestionnaire?.name || \"\",\r\n         email: gestionnaire?.email || \"\",\r\n         password: \"\",\r\n-        role: gestionnaire?.role || \"Gestionnaire\",\r\n-        isActive: gestionnaire?.isActive || true,\r\n+      \r\n     });\r\n \r\n     const handleChange = (e) => {\r\n         const { name, value } = e.target;\r\n@@ -39,10 +37,9 @@\n             const updateData = {\r\n                 id: formData.id,\r\n                 name: formData.name,\r\n                 email: formData.email,\r\n-                role: formData.role,\r\n-                isActive: formData.isActive === \"true\",\r\n+             \r\n             };\r\n             if (formData.password) {\r\n                 updateData.password = formData.password;\r\n             }\r\n@@ -93,26 +90,10 @@\n                             type=\"password\"\r\n                             value={formData.password}\r\n                             onChange={handleChange}\r\n                         />\r\n-                        <Select\r\n-                            label=\"Rôle\"\r\n-                            name=\"role\"\r\n-                            value={formData.role}\r\n-                            onChange={(value) => handleSelectChange(\"role\", value)}\r\n-                        >\r\n-                            <Option value=\"Gestionnaire\">Gestionnaire</Option>\r\n-                            <Option value=\"Admin\">Admin</Option>\r\n-                        </Select>\r\n-                        <Select\r\n-                            label=\"Statut\"\r\n-                            name=\"isActive\"\r\n-                            value={formData.isActive.toString()}\r\n-                            onChange={(value) => handleSelectChange(\"isActive\", value)}\r\n-                        >\r\n-                            <Option value=\"true\">Actif</Option>\r\n-                            <Option value=\"false\">Inactif</Option>\r\n-                        </Select>\r\n+                      \r\n+                 \r\n                     </div>\r\n                 </DialogBody>\r\n                 <DialogFooter>\r\n                     <Button\r\n"
                },
                {
                    "date": 1749325239431,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,16 +6,18 @@\n     DialogBody,\r\n     DialogFooter,\r\n     Input,\r\n     Button,\r\n-  \r\n+    Select,\r\n+    Option,\r\n } from \"@material-tailwind/react\";\r\n import { useState } from \"react\";\r\n \r\n import { ToastContainer, toast } from 'react-toastify';\r\n import 'react-toastify/dist/ReactToastify.css';\r\n \r\n function ModifierGestionnaire({ open, handleClose, gestionnaire, onGestionnaireUpdated }) {\r\n+    console.log(\"gestionnaire\",gestionnaire)\r\n     const [formData, setFormData] = useState({\r\n         id: gestionnaire?._id || \"\",\r\n         name: gestionnaire?.name || \"\",\r\n         email: gestionnaire?.email || \"\",\r\n"
                },
                {
                    "date": 1749325276032,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -73,17 +73,17 @@\n                     <div className=\"flex flex-col gap-4\">\r\n                         <Input\r\n                             label=\"Nom\"\r\n                             name=\"name\"\r\n-                            value={formData.name}\r\n+                            value={formData?.name}\r\n                             onChange={handleChange}\r\n                             required\r\n                         />\r\n                         <Input\r\n                             label=\"Email\"\r\n                             name=\"email\"\r\n                             type=\"email\"\r\n-                            value={formData.email}\r\n+                            value={formData?.email}\r\n                             onChange={handleChange}\r\n                             required\r\n                         />\r\n                         <Input\r\n"
                },
                {
                    "date": 1749325323923,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,11 +17,11 @@\n \r\n function ModifierGestionnaire({ open, handleClose, gestionnaire, onGestionnaireUpdated }) {\r\n     console.log(\"gestionnaire\",gestionnaire)\r\n     const [formData, setFormData] = useState({\r\n-        id: gestionnaire?._id || \"\",\r\n-        name: gestionnaire?.name || \"\",\r\n-        email: gestionnaire?.email || \"\",\r\n+        id: gestionnaire?._id ,\r\n+        name: gestionnaire?.name ,\r\n+        email: gestionnaire?.email ,\r\n         password: \"\",\r\n       \r\n     });\r\n \r\n@@ -29,11 +29,9 @@\n         const { name, value } = e.target;\r\n         setFormData((prev) => ({ ...prev, [name]: value }));\r\n     };\r\n \r\n-    const handleSelectChange = (name, value) => {\r\n-        setFormData((prev) => ({ ...prev, [name]: value }));\r\n-    };\r\n+   \r\n \r\n     const handleSubmit = async () => {\r\n         try {\r\n             const updateData = {\r\n"
                },
                {
                    "date": 1749325364393,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,11 +17,11 @@\n \r\n function ModifierGestionnaire({ open, handleClose, gestionnaire, onGestionnaireUpdated }) {\r\n     console.log(\"gestionnaire\",gestionnaire)\r\n     const [formData, setFormData] = useState({\r\n-        id: gestionnaire?._id ,\r\n-        name: gestionnaire?.name ,\r\n-        email: gestionnaire?.email ,\r\n+        id: gestionnaire._id ,\r\n+        name: gestionnaire.name ,\r\n+        email: gestionnaire.email ,\r\n         password: \"\",\r\n       \r\n     });\r\n \r\n"
                },
                {
                    "date": 1749325394756,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,11 +17,11 @@\n \r\n function ModifierGestionnaire({ open, handleClose, gestionnaire, onGestionnaireUpdated }) {\r\n     console.log(\"gestionnaire\",gestionnaire)\r\n     const [formData, setFormData] = useState({\r\n-        id: gestionnaire._id ,\r\n-        name: gestionnaire.name ,\r\n-        email: gestionnaire.email ,\r\n+        id: gestionnaire?._id ,\r\n+        name: gestionnaire?.name ,\r\n+        email: gestionnaire?.email ,\r\n         password: \"\",\r\n       \r\n     });\r\n \r\n"
                },
                {
                    "date": 1749325410451,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,9 +15,9 @@\n import { ToastContainer, toast } from 'react-toastify';\r\n import 'react-toastify/dist/ReactToastify.css';\r\n \r\n function ModifierGestionnaire({ open, handleClose, gestionnaire, onGestionnaireUpdated }) {\r\n-    console.log(\"gestionnaire\",gestionnaire)\r\n+  \r\n     const [formData, setFormData] = useState({\r\n         id: gestionnaire?._id ,\r\n         name: gestionnaire?.name ,\r\n         email: gestionnaire?.email ,\r\n"
                },
                {
                    "date": 1749325420649,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -71,9 +71,9 @@\n                     <div className=\"flex flex-col gap-4\">\r\n                         <Input\r\n                             label=\"Nom\"\r\n                             name=\"name\"\r\n-                            value={formData?.name}\r\n+                            defaultValue={formData?.name}\r\n                             onChange={handleChange}\r\n                             required\r\n                         />\r\n                         <Input\r\n"
                },
                {
                    "date": 1749325535267,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,53 +1,57 @@\n \r\n-import apiClient from \"@/api/client\";\r\n import {\r\n     Dialog,\r\n     DialogHeader,\r\n     DialogBody,\r\n     DialogFooter,\r\n     Input,\r\n     Button,\r\n-    Select,\r\n-    Option,\r\n } from \"@material-tailwind/react\";\r\n-import { useState } from \"react\";\r\n-\r\n+import { useState, useEffect } from \"react\";\r\n+import apiClient from \"@/api/client\";\r\n import { ToastContainer, toast } from 'react-toastify';\r\n import 'react-toastify/dist/ReactToastify.css';\r\n \r\n function ModifierGestionnaire({ open, handleClose, gestionnaire, onGestionnaireUpdated }) {\r\n-  \r\n     const [formData, setFormData] = useState({\r\n-        id: gestionnaire?._id ,\r\n-        name: gestionnaire?.name ,\r\n-        email: gestionnaire?.email ,\r\n+        id: \"\",\r\n+        name: \"\",\r\n+        email: \"\",\r\n         password: \"\",\r\n-      \r\n     });\r\n \r\n+    // Update formData when gestionnaire prop changes\r\n+    useEffect(() => {\r\n+        if (gestionnaire) {\r\n+            setFormData({\r\n+                id: gestionnaire._id || \"\",\r\n+                name: gestionnaire.name || \"\",\r\n+                email: gestionnaire.email || \"\",\r\n+                password: \"\",\r\n+            });\r\n+        }\r\n+    }, [gestionnaire]);\r\n+\r\n     const handleChange = (e) => {\r\n         const { name, value } = e.target;\r\n         setFormData((prev) => ({ ...prev, [name]: value }));\r\n     };\r\n \r\n-   \r\n-\r\n     const handleSubmit = async () => {\r\n         try {\r\n             const updateData = {\r\n                 id: formData.id,\r\n                 name: formData.name,\r\n                 email: formData.email,\r\n-             \r\n             };\r\n             if (formData.password) {\r\n                 updateData.password = formData.password;\r\n             }\r\n \r\n             const response = await apiClient.post(\"/admin/modifierByRol\", updateData);\r\n \r\n-            toast.success(`${formData.role} modifié avec succès.`, {\r\n+            toast.success(\"Gestionnaire modifié avec succès.\", {\r\n                 position: \"top-right\",\r\n                 autoClose: 3000,\r\n             });\r\n \r\n@@ -71,17 +75,17 @@\n                     <div className=\"flex flex-col gap-4\">\r\n                         <Input\r\n                             label=\"Nom\"\r\n                             name=\"name\"\r\n-                            defaultValue={formData?.name}\r\n+                            value={formData.name}\r\n                             onChange={handleChange}\r\n                             required\r\n                         />\r\n                         <Input\r\n                             label=\"Email\"\r\n                             name=\"email\"\r\n                             type=\"email\"\r\n-                            value={formData?.email}\r\n+                            value={formData.email}\r\n                             onChange={handleChange}\r\n                             required\r\n                         />\r\n                         <Input\r\n@@ -90,10 +94,8 @@\n                             type=\"password\"\r\n                             value={formData.password}\r\n                             onChange={handleChange}\r\n                         />\r\n-                      \r\n-                 \r\n                     </div>\r\n                 </DialogBody>\r\n                 <DialogFooter>\r\n                     <Button\r\n"
                }
            ],
            "date": 1749324942992,
            "name": "Commit-0",
            "content": "\r\nimport apiClient from \"@/api/client\";\r\nimport {\r\n    Dialog,\r\n    DialogHeader,\r\n    DialogBody,\r\n    DialogFooter,\r\n    Input,\r\n    Button,\r\n    Select,\r\n    Option,\r\n} from \"@material-tailwind/react\";\r\nimport { useState } from \"react\";\r\n\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\n\r\nfunction ModifierGestionnaire({ open, handleClose, gestionnaire, onGestionnaireUpdated }) {\r\n    const [formData, setFormData] = useState({\r\n        id: gestionnaire?._id || \"\",\r\n        name: gestionnaire?.name || \"\",\r\n        email: gestionnaire?.email || \"\",\r\n        password: \"\",\r\n        role: gestionnaire?.role || \"Gestionnaire\",\r\n        isActive: gestionnaire?.isActive || true,\r\n    });\r\n\r\n    const handleChange = (e) => {\r\n        const { name, value } = e.target;\r\n        setFormData((prev) => ({ ...prev, [name]: value }));\r\n    };\r\n\r\n    const handleSelectChange = (name, value) => {\r\n        setFormData((prev) => ({ ...prev, [name]: value }));\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        try {\r\n            const updateData = {\r\n                id: formData.id,\r\n                name: formData.name,\r\n                email: formData.email,\r\n                role: formData.role,\r\n                isActive: formData.isActive === \"true\",\r\n            };\r\n            if (formData.password) {\r\n                updateData.password = formData.password;\r\n            }\r\n\r\n            const response = await apiClient.post(\"/admin/modifierByRol\", updateData);\r\n\r\n            toast.success(`${formData.role} modifié avec succès.`, {\r\n                position: \"top-right\",\r\n                autoClose: 3000,\r\n            });\r\n\r\n            onGestionnaireUpdated();\r\n            handleClose();\r\n        } catch (error) {\r\n            console.error(\"Error updating gestionnaire:\", error);\r\n            toast.error(\"Erreur lors de la modification du gestionnaire.\", {\r\n                position: \"top-right\",\r\n                autoClose: 3000,\r\n            });\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <ToastContainer position=\"top-center\" />\r\n            <Dialog open={open} handler={handleClose}>\r\n                <DialogHeader>Modifier Gestionnaire</DialogHeader>\r\n                <DialogBody>\r\n                    <div className=\"flex flex-col gap-4\">\r\n                        <Input\r\n                            label=\"Nom\"\r\n                            name=\"name\"\r\n                            value={formData.name}\r\n                            onChange={handleChange}\r\n                            required\r\n                        />\r\n                        <Input\r\n                            label=\"Email\"\r\n                            name=\"email\"\r\n                            type=\"email\"\r\n                            value={formData.email}\r\n                            onChange={handleChange}\r\n                            required\r\n                        />\r\n                        <Input\r\n                            label=\"Mot de passe (laisser vide pour ne pas modifier)\"\r\n                            name=\"password\"\r\n                            type=\"password\"\r\n                            value={formData.password}\r\n                            onChange={handleChange}\r\n                        />\r\n                        <Select\r\n                            label=\"Rôle\"\r\n                            name=\"role\"\r\n                            value={formData.role}\r\n                            onChange={(value) => handleSelectChange(\"role\", value)}\r\n                        >\r\n                            <Option value=\"Gestionnaire\">Gestionnaire</Option>\r\n                            <Option value=\"Admin\">Admin</Option>\r\n                        </Select>\r\n                        <Select\r\n                            label=\"Statut\"\r\n                            name=\"isActive\"\r\n                            value={formData.isActive.toString()}\r\n                            onChange={(value) => handleSelectChange(\"isActive\", value)}\r\n                        >\r\n                            <Option value=\"true\">Actif</Option>\r\n                            <Option value=\"false\">Inactif</Option>\r\n                        </Select>\r\n                    </div>\r\n                </DialogBody>\r\n                <DialogFooter>\r\n                    <Button\r\n                        variant=\"text\"\r\n                        color=\"blue-gray\"\r\n                        onClick={handleClose}\r\n                        className=\"mr-1\"\r\n                    >\r\n                        Annuler\r\n                    </Button>\r\n                    <Button\r\n                        variant=\"gradient\"\r\n                        color=\"blue\"\r\n                        onClick={handleSubmit}\r\n                    >\r\n                        Enregistrer\r\n                    </Button>\r\n                </DialogFooter>\r\n            </Dialog>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default ModifierGestionnaire;\r\n"
        }
    ]
}